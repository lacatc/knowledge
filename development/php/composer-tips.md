# Composer Tips

## composer.json 中的版本号

包版本

在前面的例子中，我们引入的 monolog 版本指定为 1.0.*。这表示任何从 1.0 开始的开发分支，它将会匹配 1.0.0、1.0.2 或者 1.0.20。

版本约束可以用几个不同的方法来指定。

名称  实例  描述
确切的版本号  1.0.2   你可以指定包的确切版本。
范围  >=1.0 >=1.0,<2.0 >=1.0,<1.1|>=1.2   通过使用比较操作符可以指定有效的版本范围。 
有效的运算符：>、>=、<、<=、!=。 
你可以定义多个范围，用逗号隔开，这将被视为一个逻辑AND处理。一个管道符号|将作为逻辑OR处理。 
AND 的优先级高于 OR。
通配符 1.0.*   你可以使用通配符*来指定一种模式。1.0.*与>=1.0,<1.1是等效的。
赋值运算符   ~1.2    这对于遵循语义化版本号的项目非常有用。~1.2相当于>=1.2,<2.0。想要了解更多，请阅读下一小节。

下一个重要版本（波浪号运算符）

~ 最好用例子来解释： ~1.2 相当于 >=1.2,<2.0，而 ~1.2.3 相当于 >=1.2.3,<1.3。正如你所看到的这对于遵循 语义化版本号 的项目最有用。一个常见的用法是标记你所依赖的最低版本，像 ~1.2 （允许1.2以上的任何版本，但不包括2.0）。由于理论上直到2.0应该都没有向后兼容性问题，所以效果很好。你还会看到它的另一种用法，使用 ~ 指定最低版本，但允许版本号的最后一位数字上升。

注意： 虽然 2.0-beta.1 严格地说是早于 2.0，但是，根据版本约束条件， 例如 ~1.2 却不会安装这个版本。就像前面所讲的 ~1.2 只意味着 .2 部分可以改变，但是 1. 部分是固定的。

稳定性

默认情况下只有稳定的发行版才会被考虑在内。如果你也想获得 RC、beta、alpha 或 dev 版本，你可以使用 稳定标志。你可以对所有的包做 最小稳定性 设置，而不是每个依赖逐一设置。

### 国内包镜像

[http://pkg.phpcomposer.com/](http://pkg.phpcomposer.com/)

用法1: 修改全局设置

```
composer config -g repo.packagist composer https://packagist.phpcomposer.com
```

用法2: 修改项目composer.json的配置

```
composer config repo.packagist composer https://packagist.phpcomposer.com
```

> 由于composer.lock文件保存了每一个包的下载地址, 所以对于已经安装的包没有效果, 简单的解决方案是重新生成一份composer.lock文件, 或者执行`composer update`来更新composer.lock文件, 不过后者并不能将所有下载地址更新为新的下载地址, 所以条件允许的话最好用前一种方式.

对于合作项目, 建议将镜像地址设置到项目中(就是用法2), 以避免不同的开发环境安装新的包时在composer.lock中加入国外的下载地址.
